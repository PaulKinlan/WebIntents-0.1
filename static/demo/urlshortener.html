<html>
  <head>
    <script src="/lib/client.js"></script>
    
  </head>
  <body>
    <h1>Reference Application - URL Shortener</h1>
    <p>This is a reference application for a URL shortener that wants to 
      provide its services to other apps.</p>
    
    <h2>Messages Received</h2>
    <p>A simple list of all the messages that this app has recieved.</p>
    <div id="messages">
    
    </div>
  </body>
  <script>
    var messages = document.getElementById("messages");
    window.channel.initialize(
      function() {
        var data = {
          "name" : "Easy Shorten - URL Shortener"
        };
        // Register that we are providing an intent.
        window.channel.registerIntent("shorten", data, function(message, response) {
          // This handler will recieve all messages and process them.
          var el = document.createElement("div");
          var text = message.data.data;
          el.textContent = text;
          messages.appendChild(el);
          
          // FAKE shorten the URL
          var reverse = text.split("").reverse().join("");
          
          // Return some dummy data back to the client app
          if(response) {
            response({
              "data" : reverse
            });
          }
        });
      });
  </script>
</html>